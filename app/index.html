<!doctype html>
<html lang="en" ng-app="myApp">
<head>
  <meta charset="utf-8">
  <title>My AngularJS App</title>
  <link rel="stylesheet" href="css/app.css"/>
  <script src="js/jquery-2.0.3.min.js"></script>
</head>
<body>
  <ul class="menu">
    <li><a href="#/view1">view1</a></li>
    <li><a href="#/view2">view2</a></li>
    <li><a href="#/new">new</a></li>
  </ul>

  <div ng-view></div>

  <div>Angular seed app: v<span app-version></span></div>

  <form id="answerForm" action="" method="POST">
    <input type="submit" class="button">
    <div class='div1'>1: <input class="answerInput" id="1" type="text" placeholder="answer"></div>
  </form>

  <script>
    function serializeData(){
      var data = '';
      var l = $('.answerInput').length;
      for(var i =0; i < l; i++){
        var thisAnswer = $('.answerInput')[i];
        data += $(thisAnswer).attr('id') + '=' + $(thisAnswer).val() + '&'; 
      }
      console.log(data);
      return data;
    }
    $(document).keypress(function(e) {
      
        if(e.which == 13) {
          var n =  $('.answerInput').length+1;
          var myInput = 
          '<div id="div' + n + '">' + 
          n + ': <input class="answerInput" id="' + n +
          '" type="text" placeholder="answer"></div>';

          $('#answerForm').append(myInput);
          $("#"+n).focus();
          //alert('enter!');
        };
        if(e.keyCode == 8){
          var $focused = $(':focus');
          //alert($focused.val());
          var eq = $focused.val() == '';
          //console.log("equal?: "+ eq);
          if (eq) {
            var newFocusedId = Number($focused.attr('id')) -1;
            $removeElement = $('#div' + Number($focused.attr('id')));
            $removeElement.remove();
            $('#'+newFocusedId).focus();
          }
        };
    });

    $(function() {
      $('.error').hide();
      $(".button").click(function() {
        // validate and process form here
                //var dataString = 'name='+ name + '&email=' + email + '&phone=' + phone;
        //alert (dataString);return false;
        //var dataString = "name='foo'";
        $.ajax({
          type: "POST",
          url: "http://localhost:3000/answers/create",
          data: serializeData(),
          success: function() {
            /*
            $('#contact_form').html("<div id='message'></div>");
            $('#message').html("<h2>Contact Form Submitted!</h2>")
            .append("<p>We will be in touch soon.</p>")
            .hide()
            .fadeIn(1500, function() {
              $('#message').append("<img id='checkmark' src='images/check.png' />");
            });
            */
          }
        });
        return false;
      });        
    });
  
  </script>
  <!-- In production use:
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
  -->
  <script src="lib/angular/angular.js"></script>
  <script src="lib/angular/angular-route.js"></script>
  <script src="js/app.js"></script>
  <script src="js/services.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/directives.js"></script>

</body>
</html>
